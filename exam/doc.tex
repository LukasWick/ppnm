%\pdfoutput=0
\documentclass[onecolumn]{article}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{amsmath}
\usepackage[a4paper,margin=4.75cm,tmargin=3.1cm,bmargin=3.1cm]{geometry}

\title{Exam: Question 11 \\ \large \textbf{Multidimensional pseudo-random (plain Monte Carlo) vs
quasi-random (Halton and/or lattice sequence) integrators}\\
Investigate the convergence rates (of some interesting integrals in
different dimensions) as function of the number of sample points.}
\author{Lukas Martin Wick\\
Student number: 201707977}
\begin{document}


\maketitle
Three Multidimensional Monte Carlo integrators using respectively pseudo-random (plain) and quasi-random Halton and lattice sequences. 
The convergence rate has been tested on different integrals. First a simple test integral is the area of a circle wit radius $r = 1$, and

\begin{align}
   \int^{1.1}_{-1.1} dx \int^{1.1}_{-1.1} dy \rho(x,y) = \pi,
\end{align}
where, 
\begin{align}
\rho(x,y) =
\begin{cases}
    1 & \text{if } x^2+y^2\leq r^2  \\
    0 & \text{else }      %
\end{cases}
\end{align}
The convergence can be seen in Figure \ref{fig:circle}. Here the actual error is the absolute
difference to the exact result, and the estimated error is the methods expected
error. The quasi random integrators use the difference between two runs with
half of the points. In the figure the error of the integrators has been fitted.

A slightly more difficult version integrates the volume of a half sphere, for $r=\left(\frac{3}{2}\right)^(1/3)\approx 1.145$ giving
\begin{align}
    \int^{1.5}_{-1.5} dx \int^{1.5}_{-1.5} dy \rho(x,y) = \pi,
 \end{align}
 where here, 
 \begin{align}
 \rho(x,y) =
 \begin{cases}
     \sqrt{r^2-x^2+y^2} & \text{if } x^2+y^2\leq r^2  \\
     0 & \text{else }      %
 \end{cases}
\end{align}
The convergence of this can be seen in Figure \ref{fig:sphere}.

The convergence for the integral 
\begin{align}
    \int^{\pi}_{0} dx \int^{\pi}_{0} dy \int^{\pi}_{0} dz \sin(x)\sin(y)\sin(z) = 8,
\end{align}
can be seen in Figure \ref{fig:sin}. The convergence for the harder integral 
\begin{align}
    &\frac{1}{\pi^3}\int^{\pi}_{0} dx \int^{\pi}_{0} dy \int^{\pi}_{0} dz \frac{1}{1-\cos(x)\cos(y)\cos(z)}=  \frac{\Gamma\left(\frac{1}{4}\right)^4}{4\pi^3} \\&= 1.3932039296856768591842462603255,
\end{align}
can be seen in Figure \ref{fig:cos}. In all figures the fitted a is given for each method.
It is illustrated that in general, except in the case of the very hard integral, the quasi-random methods dose better 
than the pseudo-random, and that in general the Halton sequence dose slightly better than the lattice sequence, with a small difference. 
The pseudo-random integrator dose converge close to $a=0.5\Rightarrow\text{Error}\sim\frac{1}{\sqrt{N}}$ for the easy problems of the sphere and circle.
The error estimates seen fairly precise, but slightly overestimated, except for in the hard problem

\begin{figure}[h]
    \centering
    \makebox[\textwidth][c]{\input{plotCircle.tex}}
    \caption{Monte carlo convergence rate for the integral of a circle.}
    \label{fig:circle}
\end{figure}
\begin{figure}[h]
    \centering
    \makebox[\textwidth][c]{\input{plotSphere.tex}}
    \caption{Monte carlo convergence rate for the integral of a half sphere.}
    \label{fig:sphere}
\end{figure}
\begin{figure}[h]
    \centering
    \makebox[\textwidth][c]{\input{plotSin.tex}}
    \caption{Monte carlo convergence rates for the integral of $\sin(x)\sin(y)\sin(z)$.}
    \label{fig:sin}
\end{figure}
\begin{figure}[h]
    \centering
    \makebox[\textwidth][c]{\input{plotHard.tex}}
    \caption{Monte carlo convergence rates for the integral of $\frac{1}{1-\cos(x)\cos(y)\cos(z)}$.}
    \label{fig:cos}
\end{figure}

\end{document}
